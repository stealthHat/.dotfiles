export KEYTIMEOUT=1

bindkey -v

bindkey -M vicmd '?' history-beginning-search-backward
bindkey -M vicmd '/' history-beginning-search-forward
bindkey -M vicmd "k" up-line-or-history
bindkey -M vicmd "j" down-line-or-history
bindkey -M vicmd 'y' vi-yank-xclip

function vi-yank-xclip {
  zle vi-yank
  echo "$CUTBUFFER" | xclip -sel c
 }

function zle-line-init zle-keymap-select {
  zle reset-prompt
}

zle -N zle-line-init
zle -N zle-keymap-select
zle -N vi-yank-xclip
